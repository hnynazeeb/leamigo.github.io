<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Fare Configuration</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        label {
            display: block;
            margin-bottom: 5px;
        }
        input {
            margin-bottom: 10px;
            padding: 5px;
        }
        button {
            padding: 10px;
            background-color: #4CAF50;
            color: white;
            border: none;
            cursor: pointer;
            margin-top: 10px;
        }
        button:hover {
            background-color: #45a049;
        }
        table {
            margin-top: 20px;
            border-collapse: collapse;
            width: 250px;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
    </style>
</head>
<body>

<h2>Admin Fare Configuration</h2>

<div id="vehicleConfigurations">
    <!-- Vehicle configuration forms will be added here dynamically -->
</div>

<button type="button" onclick="addVehicle()">Add New Vehicle</button>

<script>
    let vehicleCount = 1;

    function addVehicle() {
        const vehicleConfigurationsDiv = document.getElementById('vehicleConfigurations');

        const vehicleForm = document.createElement('form');
        vehicleForm.innerHTML = `
            <h3>Vehicle Configuration ${vehicleCount}</h3>
            <label for="vehicleId${vehicleCount}">Vehicle ID:</label>
            <input type="number" id="vehicleId${vehicleCount}" name="vehicleId" min="1" placeholder="Enter vehicle ID">
    
            <label for="baseFare${vehicleCount}">Base Fare:</label>
            <input type="number" id="baseFare${vehicleCount}" name="baseFare" min="0" placeholder="Enter base fare">
    
            <label for="baseKm${vehicleCount}">Base Kilometers:</label>
            <input type="number" id="baseKm${vehicleCount}" name="baseKm" min="0" placeholder="Enter base kilometers">
    
            <label for="meetAndGreet${vehicleCount}">Meet and Greet:</label>
            <select id="meetAndGreet${vehicleCount}" name="meetAndGreet">
                <option value="no">No</option>
                <option value="yes">Yes</option>
            </select>
    
            <div id="meetAndGreetCostContainer${vehicleCount}" style="display: none;">
                <label for="meetAndGreetCost${vehicleCount}">Meet and Greet Cost:</label>
                <input type="number" id="meetAndGreetCost${vehicleCount}" name="meetAndGreetCost" min="0" placeholder="Enter meet and greet cost">
            </div>
    
            <label for="stepValues${vehicleCount}">Step Values (comma-separated):</label>
            <input type="text" id="stepValues${vehicleCount}" name="stepValues" placeholder="e.g., 10,20,40,80,200">
    
            <label for="stepFactors${vehicleCount}">Step Factors (comma-separated):</label>
            <input type="text" id="stepFactors${vehicleCount}" name="stepFactors" placeholder="e.g., 1.4,1.3,1.2,1.1,1.3">
    
            <label for="currency${vehicleCount}">Currency:</label>
            <input type="text" id="currency${vehicleCount}" name="currency" placeholder="Enter currency">
        `;

        vehicleConfigurationsDiv.appendChild(vehicleForm);

        document.getElementById(`meetAndGreet${vehicleCount}`).addEventListener('change', function () {
            const meetAndGreetCostContainer = document.getElementById(`meetAndGreetCostContainer${vehicleCount}`);
            const meetAndGreetCostInput = document.getElementById(`meetAndGreetCost${vehicleCount}`);

            if (this.value === 'yes') {
                meetAndGreetCostContainer.style.display = 'none';
                meetAndGreetCostInput.value = '';  // Reset the value when switching to "Yes"
            } else {
                meetAndGreetCostContainer.style.display = 'block';
            }
        });

        vehicleCount++;
    }

    function setFare() {
        // Logic to set fare for all vehicles can be implemented here.
        // You can loop through the dynamically created forms and extract the values.
        // For simplicity, I'm just logging the values for now.
        const vehicleForms = document.querySelectorAll('form');
        const fareConfigurations = [];

        vehicleForms.forEach((form, index) => {
            const vehicleId = form.querySelector(`#vehicleId${index + 1}`).value;
            const baseFare = form.querySelector(`#baseFare${index + 1}`).value;
            const baseKm = form.querySelector(`#baseKm${index + 1}`).value;
            const meetAndGreet = form.querySelector(`#meetAndGreet${index + 1}`).value;
            const meetAndGreetCost = meetAndGreet === 'yes' ? 0 : form.querySelector(`#meetAndGreetCost${index + 1}`).value;
            const stepValues = form.querySelector(`#stepValues${index + 1}`).value.split(',').map(Number);
            const stepFactors = form.querySelector(`#stepFactors${index + 1}`).value.split(',').map(Number);
            const currency = form.querySelector(`#currency${index + 1}`).value;

            const fareConfig = {
                "formula": {
                    "meet": {
                        "cost": parseFloat(meetAndGreetCost),
                        "included": meetAndGreet === 'yes' ? 1 : 0
                    },
                    "step": {}
                },
                "base_km": parseInt(baseKm),
                "base_fare": parseInt(baseFare),
                "vehicle_id": parseInt(vehicleId)
            };

            stepValues.forEach((value, stepIndex) => {
                fareConfig.formula.step[value] = stepFactors[stepIndex];
            });

            fareConfigurations.push(fareConfig);
        });

        // You can use the fareConfigurations array as needed (e.g., send it to the server, update an existing JSON, etc.).
        console.log("Fare configurations set:", fareConfigurations);
        alert("Fare configurations set!");  // You can replace this with your specific action.
    }
</script>

</body>
</html>


